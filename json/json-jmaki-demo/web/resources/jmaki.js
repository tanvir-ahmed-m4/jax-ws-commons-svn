var _globalScope=this;function Jmaki(){this.version=".9.1";this.debugGlue=false;this.debug=false;var _1=this;var _2=[];var _3=[];this.loaded=false;this.initialized=false;this.webRoot="";this.resourcesRoot="resources";this.Map=function(){var _4={};this.keys=function(){var o={};var _6=[];for(var _i in _4){if(typeof o[_i]=="undefined"){_6.push(_i);}}return _6;};this.put=function(_8,_9){_4[_8]=_9;};this.get=function(_a){return _4[_a];};this.remove=function(_b){delete _4[_b];};this.clear=function(){delete _4;_4={};};};this.attributes=new this.Map();var _c=new this.Map();this.subscribe=function(_d,_l){var _f=_c.get(_d);if(!_f){_f=[];_c.put(_d,_f);}for(var i in _f){if(i==_l){return;}}_f.push(_l);};this.unsubscribe=function(_11,_12){var _13=_c.get(_11);if(_13){for(var i=0;i<_13.length;i++){if(_13[i]==_12){_13.splice(i,1);break;}}}};this.publish=function(_15,_16,_17,_18){if(typeof _15=="undefined"||typeof _16=="undefined"){return;}var _19=_c.get(_15);if(_1.debugGlue){var _me=_16;if(typeof _16=="object"){var _m=[];for(var _o in _16){_m.push(_o+" : "+_16[_o]);}if(_m.length>0){_me="{"+_m.join(" , ")+"}";}else{_me="{}";}}_1.log("<span style='color:red'>Publish </span> : Topic:"+_15+" message: "+_me);}if(!_19){_19=[];_c.put(_15,_19);}for(var _1d=0;_1d<_19.length;_1d++){if(typeof _19[_1d]=="function"){_19[_1d](_16);}}if(_1.debugGlue&&_19.length>0){_1.log("<span style='color:green'>Point to Point Pubish match</span> : Topic:"+_15+" listeners : "+_19.length);}if(_1.config&&_1.config.glue&&_1.config.glue.listeners){for(var _l=0;_l<_1.config.glue.listeners.length;_l++){var _1f=_1.config.glue.listeners[_l];if((_1f.topic instanceof RegExp&&_1f.topic.test(_15))||(_1f.topic==_15)||(typeof _1f.topic.charAt=="function"&&_1f.topic.charAt(_1f.topic.length-1)=="*"&&(_15.indexOf(_1f.topic.substring(0,_1f.topic.length-1))==0)&&_15.substring(0,_1f.topic.length-1)==_1f.topic.substring(0,_1f.topic.length-1))||(typeof _1f.topic.charAt=="function"&&_1f.topic.charAt(0)=="*"&&_15.indexOf(_1f.topic.substring(1,_1f.topic.length)!=-1)&&_15.substring(_15.indexOf(_1f.topic.substring(1,_1f.topic.length)),_15.length)==_1f.topic.substring(1,_1f.topic.length))||(typeof _1f.topic.charAt=="function"&&_1f.topic.charAt(0)=="*"&&_1f.topic.charAt(_1f.topic.length-1)=="*"&&_15.indexOf(_1f.topic.substring(1,_1f.topic.length-1)!=-1))){if(_1.debugGlue){_1.log("<span style='color:green'>Publish Match</span> : Topic:"+_15+" listener: "+_1f);}if(_1f.action=="call"&&_1f.target){var _20;if(_1f.target.functionName){_20=_1.findObject(_1f.target.object);if(typeof _20=="function"){myo=new _20;}else{if(_20){myo=_20;}else{if(_1.debugGlue){_1.log("Publish Error :  Object found: "+_1f.target.object);}}}if(typeof myo!="undefined"&&typeof myo[_1f.target.functionName]=="function"){myo[_1f.target.functionName].call(_globalScope,_16);}else{if(_1.debugGlue){_1.log("Publish Error : function "+_1f.target.functionName+" not found on object "+_1f.target.object);}}}else{if(_1f.target.functionHandler){_1f.target.functionHandler.call(_globalScope,_16);}else{if(_1.debugGlue){_1.log("Publish Error : no fuctionName or functionHandler specified on listener mapped to "+_15);}}}}}else{if(_1.config.glue.listeners[_l].action=="forward"){var _21=_1.config.glue.listeners[_l].topics;for(var ti=0;ti<_21.length;ti++){if(_21[ti]!=_15){_1.publish(_21[ti],_16);}}}}}}var bd=true;if(typeof _17!="undefined"){bd=_17;}if(bd&&window.frames.length>0){for(var i=0;i<window.frames.length;i++){if(window.frames[i].jmaki){window.frames[i].jmaki.publish("/global"+_15,_16,true,false);}}}if(window!=window.top){var bu=true;if(typeof _18!="undefined"){bu=_18;}if(bu&&window.parent.jmaki){window.parent.jmaki.publish("/global"+_15,_16,false,true);}}};this.addLibraries=function(_26,_cb,_28){if(_26.length<=0){if(typeof _cb=="function"){_cb();return;}}if(typeof _28=="undefined"){_28=new _1.Map();}var _29=new Date().getMilliseconds();var _2a=_26[_26.length-1];if(_1.blocked){for(var b=0;b<_1.blocked.length;b++){if(_2a.indexOf(_1.blocked[b])!=-1){return _2a;}}}var _2c="c_script_"+_26.length+"_"+_29;var _2d=document.getElementsByTagName("head")[0];var e=document.createElement("script");e.start=_29;e.id=_2c;e.type="text/javascript";_2d.appendChild(e);var se=document.getElementById(_2c);_28.put(_2c,_2a);var _30=function(_id){var t=document.getElementById(_id);if(t.timeoutHandler){clearInterval(t.timeoutHandler.interval);delete t.timeoutHandler;}var _s=document.getElementById(_id);if(_s){_s.parentNode.removeChild(_s);}_28.remove(_id);var _34=_cb;if(_26.length-1>0){_26.pop();_1.addLibraries(_26,_cb,_28);}if(_28.keys().length==0){if(typeof _cb!="undefined"){var _35=0;delete _28;setTimeout(function(){_34();},0);}}};if(/MSIE/i.test(navigator.userAgent)){se.onreadystatechange=function(){if(this.readyState=="loaded"){var _id=_2c;_30(_id);}};document.getElementById(_2c).src=_2a;}else{if(se.addEventListener){var _37=function(_id){var _c=0;var _3a=this;this.interval=setInterval(function(){if(_c>2){clearInterval(_3a.interval);_30(_id);}else{_c++;}},250);};se.timeoutHandler=new _37(_2c);se.addEventListener("load",function(){var _id=_2c;_30(_id);},true);}setTimeout(function(){document.getElementById(_2c).src=_2a;},0);}se=null;_2d=null;};this.getXHR=function(){if(window.XMLHttpRequest){return new XMLHttpRequest();}else{if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP");}}};this.doAjax=function(_3c){if(typeof _3c=="undefined"||!_3c.url){return;}var _3d=this.getXHR();var _3e="GET";var _3f=true;var _40;if(typeof _3c.asynchronous!="undefined"){_3f=_3c.asynchronous;}if(_3c.method){_3e=_3c.method;}if(typeof _3c.callback=="function"){_40=_3c.callback;}var _41=null;if(_3c.body){_41=_3c.body;}if(_3c.content){_41="";for(var l in _3c.content){if(typeof _3c.content[l]=="string"){_41=_41+l+"="+encodeURIComponent(_3c.content[l])+"&";}}}if(_3f==true){_3d.onreadystatechange=function(){_40(_3d);};}_3d.open(_3e,_3c.url,_3f);if(_3c.method){_3e=_3c.method;if(_3e.toLowerCase()=="post"&&!_3c.headers){_3d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}}if(_3c.headers){for(var _h=0;h<_3c.headers.length;_h++){_3d.setRequestHeader(_3c.headers[_h].name,_3c.headers[_h].value);}}_3d.send(_41);if(_40){return _40(_3d);}};this.addType=function(_44){var _45=null;if(_1.config&&_1.config.types){for(var _i=0;_i<_1.config.types.length;_i++){if(_44==_1.config.types[_i].id){_45=_1.config.types[_i];break;}}if(_45){if(_45.preload){_globalScope.eval(_45.preload);}var _47=[];for(var _i=0;_i<_45.libs.length;_i++){if(!this.isScriptLoaded(this.webRoot+_45.libs[_i])){_47.push(this.webRoot+_45.libs[_i]);}}var _cb;if(_45.postload){_cb=function(){var _4a=_45.postload;_globalScope.eval(_4a);};}this.addLibraries(_47,_cb);}}};this.addLibrary=function(lib){var se=document.createElement("script");se.src=lib;if(/WebKit/i.test(navigator.userAgent)){document.body.appendChild(se);}else{var _4d=document.getElementsByTagName("head")[0];_4d.appendChild(se);}};this.addWidget=function(_4e){_3.push(_4e);if(this.loaded){this.loadWidget(_4e);}};this.bootstrapWidgets=function(){_1.loaded=true;for(var l=0;l<_3.length;l++){this.loadWidget(_3[l]);}};this.writeScript=function(_s,_id){if(_1.loaded==true){if(document.getElementById(_id)){document.getElementById(_id).innerHTML="Attempt to write a script that can not be dynamically load widget with  id "+_id+". Consider using the widget in an iframe.";}}else{document.write("<script src='"+_s+"'></script>");}};this.loadScript=function(_52){if(!/http/.test(_52)){_52=this.webRoot+_52;}var req=this.getXHR();req.open("GET",_52,false);try{req.send(null);}catch(e){_1.log("error loading : "+_52);}if(req.status==200){return window.eval(req.responseText);}};this.loadStyle=function(_54){var _55=document.createElement("link");_55.type="text/css";_55.rel="stylesheet";if(_54[0]=="/"){_54=_1.webRoot+_54;}_55.href=_54;if(document.getElementsByTagName("head").length==0){var _56=document.createElement("head");document.documentElement.insertBefore(_56,document.documentElement.firstChild);}document.getElementsByTagName("head")[0].appendChild(_55);};this.replaceStyleClass=function(_57,_58,_59){var _5a=this.getElementsByStyle(_58,_57);for(var i=0;i<_5a.length;i++){if(_5a[i].className.indexOf(" ")!=-1){var _5c=_5a[i].className.split(" ");for(var ci in _5c){if(_5c[ci]==_58){_5c[ci]=_59;}}_5a[i].className=_5c.join(" ");}else{if(_5a[i].className==_58){_5a[i].className=_59;}}}};this.getElementsByStyle=function(_5e,_5f){var _60=[];if(typeof _5f!="undefined"){var _61=_5f;if(typeof _5f=="string"){_61=document.getElementById(_5f);}_60=this.getAllChildren(_61,[]);}else{_60=(document.all)?document.all:document.getElementsByTagName("*");}var _62=[];for(var i=0;i<_60.length;i++){if(_60[i].className.indexOf(" ")!=-1){var cn=_60[i].className.split(" ");for(var ci=0;ci<cn.length;ci++){if(cn[ci]==_5e){_62.push(_60[i]);}}}else{if(_60[i].className==_5e){_62.push(_60[i]);}}}return _62;};this.getAllChildren=function(_66,_67){var _nc=_66.childNodes;for(var l=0;l<_nc.length;l++){if(_nc[l].nodeType==1){_67.push(_nc[l]);if(_nc[l].childNodes.length>0){this.getAllChildren(_nc[l],_67);}}}return _67;};this.loadWidget=function(_6a){if(_1.attributes.get(_6a.uuid)!=null){return;}var _6b="jmaki.widgets."+_6a.name+".Widget";var con=this.findObject(_6b);if(typeof con!="function"){logError("Could not find widget constructor for: "+_6b+". Please make sure the widget constructor is properly defined.",document.getElementById(_6a.uuid));}var _6d;if((typeof _6a.value=="string")&&_6a.value.indexOf("@{")==0){var _vw=/[^@{].*[^}]/.exec(_6a.value);_6a.value=_1.findObject(new String(_vw));}var _6f=_6a.uuid;if(/MSIE/i.test(navigator.userAgent)){var _70=_6a.uuid;var _71=null;if(window.onerror){_71=window.onerror;}var eh=function(_73,url,_75){var _76=_70;logWidgetError(_6b,_76,url,_75,_73,document.getElementById(_76));};window.onerror=eh;_6d=new con(_6a);window.onerror=null;if(_71){window.onerror=_71;}}else{if(typeof con=="function"){try{_6d=new con(_6a);}catch(e){var _77="unknown";var _78=null;if(e.lineNumber){_77=e.lineNumber;}if(e.message){_78=e.message;}if(_1.debug){logWidgetError(_6b,_6a.uuid,_6a.script,_77,_78,document.getElementById(_6a.uuid));return;}}}else{if(typeof con=="undefined"){logError("Unable to find widget constructor "+_6b+" check log and make sure constructor is defined.",document.getElementById(_6a.uuid));return;}}}if(typeof _6d=="object"){_1.attributes.put(_6a.uuid,_6d);if(_6d.postLoad=="function"){_6d.postLoad();}_1.publish("/jmaki/runtime/widget/loaded",_6a);}else{logError("Unable to create an instance of "+_6b+". See the error log for more detials.",document.getElementById(_6a.uuid));}};function logWidgetError(_79,_7a,url,_7c,_m,div){var _7f="<span>Error loading "+_79+" : id="+_7a+"<br>"+"Script: "+url+" (line:"+_7c+")."+"<br>Message: "+_m+"</span>";logError(_7f,div);}function logError(_80,div){if(div==null||typeof div.className=="undefined"){div=document.createElement("div");document.body.appendChild(div);}div.className="";div.style.color="red";div.innerHTML=_80;}this.getWidget=function(id){return _1.attributes.get(id);};this.clearWidgets=function(_83){if(typeof _83=="undefined"){var _k=_1.attributes.keys();for(var l=0;l<_k.length;l++){if(typeof _1.attributes.get(_k[l]).destroy!="undefined"&&typeof _1.attributes.get(_k[l]).destroy=="function"){_1.attributes.get(_k[l]).destroy();}_1.attributes.remove(_k[l]);}_1.loaded=false;_3=[];}else{var _ws=_1.getAllChildren(_83,[]);for(var l=0;l<_ws.length;l++){if(_ws[l].id&&_1.attributes.get(_ws[l].id)&&typeof _1.attributes.get(_ws[l].id).destroy=="function"){_1.attributes.get(_ws[l].id).destroy();var _p=document.getElementById(_ws[l].id);_p.parentNode.removeChild(_p);}_1.attributes.remove(_ws[l].id);}}};this.addGlueListener=function(l,t){if(!_1.config){_1.config={};}if(!_1.config.glue){_1.config.glue={};}if(!_1.config.glue.listeners){_1.config.glue.listeners=[];}if(typeof l=="object"&&!(l instanceof RegExp)){if(l.topic){l.topic=l.topic.replace(/^\s+|\s+$/g,"");}if(l.topicRegExp){l.topic=new RegExp(l.topicRegExp);}lis=l;}else{if(typeof t=="string"){lis={};if(l.topicRegExp){lis.topic=new RegExp(l.topicRegExp);}else{lis.topic=l;}lis.target={};var _is=t.split(".");lis.action="call";lis.target.functionName=_is.pop();lis.target.object=_is.join(".");}else{if(typeof t=="function"){lis={};if(l.topicRegExp){lis.topic=new RegExp(l.topicRegExp);}else{lis.topic=l;}lis.target={};lis.action="call";lis.target.functionHandler=t;}else{_1.log("don't know what to do with "+l);}}}if(typeof lis!="undefined"){_1.config.glue.listeners.push(lis);}};this.extend=function(_8c,_8d){_8c.prototype=new _8d();_8c.prototype.constructor=_8c;_8c.superclass=_8d.prototype;for(i in _8d){_8c.prototype[i]=_8d[i];}};this.log=function(_8e,_8f){if(!_1.debug){return;}if(!_1.ld){var ld=document.createElement("div");ld.style.border="1px solid #000000";ld.style.fontSize="12px";ld.style.position="absolute";ld.style.zIndex="999";ld.style.bottom="0px";ld.style.background="yellow";ld.style.right="0px";ld.style.width="400px";ld.style.height="200px";ld.style.overflowY="auto";document.body.appendChild(ld);_1.ld=ld;}var lm=document.createElement("div");lm.innerHTML=_8e;_1.ld.appendChild(lm);};this.initialize=function(){if(!_1.config){_1.config={};}if(!_1.config.glue){_1.config.glue={};}var req=this.getXHR();try{req.open("GET",this.webRoot+this.resourcesRoot+"/config.json",false);req.send(null);}catch(e){}if(req.readyState==4){if(req.status==200){if(req.responseText==""){return;}var obj=eval("("+req.responseText+")");if(obj.config){_1.config.theme=obj.config.theme;if(obj.config.glue.timers){_1.addTimers(obj.config.glue.timers);}if(obj.config.gluelisteners){for(var gl=0;gl<obj.config.glue.listeners.length;gl++){_1.addGlueListener(obj.config.glue.listeners[gl]);}}}}}postInitialize();};var _95=[];this.namespace=function(_96,_97){var _98=_96.split(".");var _99=_globalScope[_98[0]];if(typeof _99=="undefined"){_globalScope[_98[0]]=_99={};}for(var ii=1;ii<_98.length;ii++){if(typeof _99[_98[ii]]!="undefined"){_99=_99[_98[ii]];}else{_99[_98[ii]]={};_99=_99[_98[ii]];}}if(typeof _97=="object"){_99=_97;}return _99;};this.findObject=function(_9b){var _9c=_9b.split(".");var _9d=_globalScope[_9c[0]];var _9e=true;if(typeof _9d!="undefined"){for(var ii=1;ii<_9c.length;ii++){var _lp=_9c[ii];if(_lp.indexOf("()")!=-1){var _ns=_lp.split("()");if(typeof _9d[_ns[0]]=="function"){var _fn=_9d[_ns[0]];return _fn.call(_globalScope);}}if(typeof _9d[_lp]!="undefined"){_9d=_9d[_lp];_9e=true;}else{_9e=false;break;}}if(_9e){return _9d;}}return null;};this.Timer=function(_a3,_a4){var _a5=this;this.args=_a3;var _a6;this.processTopic=function(){for(var ti=0;ti<_a3.topics.length;ti++){_1.publish(_a3.topics[ti],{topic:_a3.topics[ti],type:"timer",src:_a5,timeout:_a3.to});}};this.processCall=function(){if(!_a6){var _a8=_1.findObject(_a3.on);if(typeof _a8=="function"){_a6=new _a8();}else{if(typeof _a8=="object"){_a6=_a8;}}}if((_a6&&typeof _a6=="object")){if(typeof _a6[_a3.fn]=="function"){_a6[_a3.fn]({type:"timer",src:_a5,timeout:_a3.to});}}};this.run=function(){if(_a4){_a5.processCall();}else{_a5.processTopic();}_globalScope.setTimeout(_a5.run,_a3.to);};};this.addTimer=function(_a9){var _aa=[];_aa.push(_a9);this.addTimers(_aa);};this.addTimers=function(_ab){if(typeof _ab!="undefined"){for(var _l=0;_l<_ab.length;_l++){var _ad=_ab[_l];if(_ad.action=="call"&&_ad.target!="undefined"&&_ad.target.object!="undefined"&&_ad.target.functionName!="undefined"&&typeof _ad.timeout!="undefined"){var _ae={on:_ad.target.object,fn:_ad.target.functionName,to:_ad.timeout};var _af=new _1.Timer(_ae,true);_95.push(_af);_af.run();}else{if(_ab[_l].action=="publish"){var _b0={topics:_ab[_l].topics,to:_ad.timeout};var _b1=new _1.Timer(_b0,false);_95.push(_b1);_b1.run();}}}}};function postInitialize(){if(_1.initialized){return;}else{_1.initialized=true;}_1.publish("/jmaki/runtime/intialized",{});_1.bootstrapWidgets();_1.publish("/jmaki/runtime/widgetsLoaded",{});if(_1.config&&_1.config.theme){var _b2=_1.config.theme;if(!/(^http)/i.test(_b2)){_b2=_1.webRoot+_b2;}_1.loadStyle(_b2);}_1.publish("/jmaki/runtime/loadComplete",{});}this.filter=function(_b3,_b4){if(typeof _b4=="string"){var h=_1.findObject(_b4);return h.call(_globalScope,_b3);}else{if(typeof _b4=="function"){return _b4.call(_globalScope,_b3);}}};this.DContainer=function(_b6){var _b7=this;var _b8;var _b9;var ie=/MSIE/i.test(navigator.userAgent);if(typeof _b6.target=="string"){_b8=_b6.target;_b9=document.getElementById(target);}else{_b8=_b6.target.id;_b9=_b6.target;}if(typeof overflow!="undefined"&&_b9.style.overflow){_b9.style.overflow="true";}var _bb;this.url=null;var _bc=false;var _bd=false;if(_b6.autosize){_bc=true;_bd=true;}var _be;var _bf;this.loadURL=function(_c0){if(typeof _c0!="undefined"){if(typeof _c0=="string"){_b7.url=_c0;}else{if(_c0.url){_b7.url=_c0.url;}}if(_b6.useIframe){_b7.iframe.src=_b7.url;}else{_1.injector.inject({url:_b7.url,injectionPoint:_b9});}}};function getPosition(_e){var pX=0;var pY=0;try{while(_e.offsetParent){pY+=_e.offsetTop;pX+=_e.offsetLeft;_e=_e.offsetParent;}}catch(e){}return {x:pX,y:pY};}this.resize=function(){var pos=getPosition(_b9);if(_bc||_bd){if(!_b9.parentNode){return;}var pos=getPosition(_b9);if(_b9.parentNode.nodeName=="BODY"){if(window.innerHeight){_bf=window.innerHeight-pos.y-40;_be=window.innerWidth-20;}else{var _c6=_b9.parentNode;while(_c6!=null&&(_c6.clientHeight==0||typeof _c6.clientWidth=="undefined")){_c6=_c6.parentNode;}if(_c6==null){_be=400;}else{_be=_c6.clientWidth-20;_bf=_c6.clientHeight-pos.y-15;}}}else{var _c7=_b9.parentNode;while(_c7!=null&&(_c7.clientHeight==0||typeof _c7.clientWidth=="undefined")){_c7=_c7.parentNode;}if(_c7==null){_be=400;}else{_be=_c7.clientWidth;_bf=_c7.clientHeight;}}if(_bc){if(_bf<0){_bf=320;}_b9.style.height=_bf+"px";}if(_bd){_b9.style.width=_be+"px";}}else{_b9.style.width=_be+"px";_b9.style.height=_bf+"px";}if(_bf<0){_bf=320;}if(_be<0){_be=500;}if(_b6.useIframe){if(_b7.iframe){_b7.iframe.style.height=_bf+"px";_b7.iframe.style.width=_be+"px";}}_bb=document.body.clientWidth;};function init(){if(window.attachEvent){window.attachEvent("onresize",layout);}else{if(window.addEventListener){window.addEventListener("resize",layout,true);}}if(_b6.startWidth){_be=Number(_b6.startWidth);_b9.style.width=_be+"px";}else{_be=_b9.clientWidth;_bd=true;}if(_b6.startHeight){_bf=Number(_b6.startHeight);}else{_bf=_b9.clientHeight;_bc=true;}if(_bf<=0){_bf=320;}_b9.style.height=_bf+"px";if(_b6.useIFrame&&_b7.iframe){_b7.iframe.style.height=_bf+"px";}_1.subscribe(_b6.topic,_b7.loadURL);_b7.resize();if(_b6.url&&!_b6.useIframe){_b7.loadURL(_b6.url);}}var _c8=false;var _c9=0;function layout(){if(!ie){_b7.resize();return;}if(_bb!=document.body.clientWidth&&!_c8){if(!_c8){_c8=true;setTimeout(layout,500);}}else{if(_c8&&document.body.clientWidth==_c9){_c8=false;_b7.resize();}else{if(_c8){_c9=document.body.clientWidth;setTimeout(layout,500);}}}}if(_b6.useIframe&&_b6.useIframe==true){var _ca="";if(_b6.url){_ca="src='"+_b6.url+"'";}var _cb="<IFRAME ID='"+_b8+"_iframe' "+_ca+" FRAMEBORDER=0 SCROLLING="+((!_b6.overflow)?"NO":"YES")+"></IFRAME>";_b9.innerHTML=_cb;var _t=setInterval(function(){if(document.getElementById(_b8+"_iframe")){clearInterval(_t);_b7.iframe=document.getElementById(_b8+"_iframe");setTimeout(function(){init();},0);}},5);}else{init();}};this.destroy=function(){if(window.attachEvent){window.dettachEvent("onresize",layout);}else{if(window.addEventListener){window.removeEventListener("resize",layout,true);}}};this.Injector=function(){var _cd=new Date().getMilliseconds();var _ce=this;var _cf=false;var _d0=[];var _d1=[];this.inject=function(_d2){if(_d1.length==0&&!_cf){inject(_d2);}else{_d1.push(_d2);}};function inject(_d3){_cf=true;_1.doAjax({method:"GET",url:_d3.url,asynchronous:false,callback:function(req){if(req.readyState==4){getContent(req.responseText,_d3);var _d5;if(typeof _d3.injectionPoint=="string"){_d5=document.getElementById(_d3.injectionPoint);if(!document.getElementById(_d3.injectionPoint)){var _t=setInterval(function(){if(document.getElementById(_d3.injectionPoint)){clearInterval(_t);_d5=document.getElementById(_d3.injectionPoint);setTimeout(function(){processTask(_d5,_d3);},0);}},25);}else{processTask(_d5,_d3);}}else{processTask(_d3.injectionPoint,_d3);}}}});}function processTask(_d7,_d8){_1.clearWidgets(_d7);var _id="injector_"+_cd;var _da=_d8.content+"<div id='"+_id+"'></div>";_d7.innerHTML=_da;var _t=setInterval(function(){if(document.getElementById(_id)){clearInterval(_t);try{_ce.loadScripts(_d8,processNextTask);}catch(e){_d7.innerHTML="<span style='color:red'>"+e.message+"</span>";}}},25);}function processNextTask(){if(_d1.length>0){var _t=_d1.shift();inject(_t);}_cf=false;}this.get=function(p){var _de;_1.doAjax({method:"GET",url:p.url,asynchronous:false,callback:function(req){_de=getContent(req.responseText);}});return _de;};function getContent(_e0,_e1){_e1.embeddedScripts=[];_e1.embeddedStyles=[];_e1.scriptReferences=[];_e1.styleReferences=[];var _t=_e0;var _e3="";var _e4=document.getElementsByTagName("script");var _e5=document.getElementsByTagName("link");while(_t.indexOf("<script")!=-1){var _e6=_t.indexOf("<script");var _e7=_t.indexOf("src=",(_e6));var _e8=_t.indexOf(">",_e6);var end=_t.indexOf("</script>",(_e6))+"</script>".length;if(_e6!=-1&&_e7!=-1){var _ea;var _eb=_e7+5;var _ec=_t.substring(_e7+4,(_e7+5));var _ed=_t.indexOf("\"",(_eb+1));_ed=_t.indexOf(_ec,(_eb+1));if(_e7<_e8){_ea=_t.substring(_eb,_ed);var _ee=false;for(var i=0;i<_e4.length;i++){if(typeof _e4[i].src){if(_e4[i].src==_ea){_ee=true;break;}}}if(!_ee){_e1.scriptReferences.push(_ea);}}}var _f0=_e8+1;var _f1=_t.substring(_f0,end-"</script>".length);if(_f1.length>0){_e1.embeddedScripts.push(_f1);}_t=_t.substring(0,_e6)+_t.substring(end,_t.length);_ed=-1;}while(_t.indexOf("<style")!=-1){var _f2=_t.indexOf("<style");var _f3=_t.indexOf(">",_f2);var end=_t.indexOf("</style>",(_f2));var _f5=_f3+1;var _f6=_t.substring(_f5,end);if(_f6.length>0){_e1.embeddedStyles.push(_f6);}_t=_t.substring(0,_f2)+_t.substring(end+"</style>".length,_t.length);}while(_t.indexOf("<link")!=-1){var _f7=_t.indexOf("<link");var _f8=_t.indexOf("href=",(_f7));var _f9=_t.indexOf(">",_f7)+1;if(_f7!=-1&&_f8!=-1){var _fa;var _fb=_f8+6;var _fc=_t.substring(_f8+5,(_f8+6));var _fd=_t.indexOf(_fc,(_fb+1));if(_f8<_f9){styleSourceName=_t.substring(_fb,_fd);var _fe=false;for(var i=0;i<_e5.length;i++){if(typeof _e5[i].src!="undefined"){if(_e5[i].src==styleSourceName){_fe=true;}}}if(!_fe){_e1.styleReferences.push(styleSourceName);}}_t=_t.substring(0,_f7)+_t.substring(_f9,_t.length);}}var head=document.getElementsByTagName("head")[0];for(var loop=0;loop<_e1.styleReferences.length;loop++){var link=document.createElement("link");link.href=_e1.styleReferences[loop];link.type="text/css";link.rel="stylesheet";head.appendChild(link);}var _103;if(_e1.embeddedStyles.length>0){_103=document.createElement("style");_103.type="text/css";var _104;for(var loop=0;loop<_e1.embeddedStyles.length;loop++){_104=_104+_e1.embeddedStyles[loop];}if(document.styleSheets[0].cssText){document.styleSheets[0].cssText=document.styleSheets[0].cssText+_104;}else{_103.appendChild(document.createTextNode(_104));head.appendChild(_103);}}_e1.content=_t;}this.loadScripts=function(task,_107){var _108=function(){for(var loop=0;loop<task.embeddedScripts.length;loop++){var _10a=task.embeddedScripts[loop];eval(_10a);if(loop==(task.embeddedScripts.length-1)){if(typeof _107!="undefined"){_107();}return;}}if(task.embeddedScripts.length==0&&typeof _107!="undefined"){_107();}};if(task.scriptReferences.length>0){return this.addLibraries(task.scriptReferences.reverse(),_108);}else{_108();}return true;};this.addLibraries=function(_10b,_cb,_10d){if(typeof _10d=="undefined"){_10d=new _1.Map();}var _lib=_10b[_10b.length-1];return _1.addLibraries(_10b,_cb,_10d);};};this.injector=new this.Injector();}if(!jmaki){var jmaki=new Jmaki();jmaki.widgets={};var oldLoad=window.onload;window.onload=function(){if(!jmaki.initialized){jmaki.initialize();}else{jmaki.bootstrapWidgets();return;}if(typeof oldLoad=="function"){oldLoad();}};}